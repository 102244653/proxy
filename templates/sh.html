<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å±±æµ·æ•°è—äº¤æ˜“å®æ—¶æŸ¥è¯¢</title>
  <style>
    :root {
      --primary-color: #00a8ff;
      --secondary-color: #0097e6;
      --dark-color: #1e272e;
      --light-color: #f5f6fa;
      --accent-color: #00d2d3;
      --success-color: #4cd137;
      --danger-color: #e84118;
    }
    
    body {
      font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #1e272e 0%, #485460 100%);
      color: var(--light-color);
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('https://img0.baidu.com/it/u=4173055281,3318406456&fm=253&fmt=auto&app=120&f=JPEG') no-repeat center center;
      background-size: cover;
      opacity: 0.5;
      z-index: -1;
    }
    
    .header {
      background: rgba(30, 39, 46, 0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 20px 0;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .header-content {
      max-width: 1800px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .page-title {
      font-size: 28px;
      font-weight: 700;
      margin: 0 0 20px 0;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-align: center;
      letter-spacing: 1px;
    }
    
    /* é»˜è®¤PCæ ·å¼ */
    /* éšè—å±•å¼€/æŠ˜å æœç´¢æŒ‰é’® */
    .toggle-search-btn {
      display: none !important;
    }
    
    /* PCä¸Šéšè—core-controlså®¹å™¨ï¼Œç›´æ¥ä½¿ç”¨header-controlså¸ƒå±€ */
    .core-controls {
      display: none !important;
    }
    
    /* PCä¸Šåˆ·æ–°æŒ‰é’®ä½ç½®è°ƒæ•´ - æ˜¾ç¤ºåœ¨ç­›é€‰ç»„ä»¶å·¦è¾¹ */
    @media (min-width: 769px) {
      .header-controls {
        flex-direction: row !important;
        flex-wrap: wrap !important;
        justify-content: center !important;
        gap: 15px !important;
      }
      
      .header-controls > .btn-primary {
        order: 1;
      }
      
      /* PCä¸Šå¹³å°ä¸‹æ‹‰æ¡†æ”¾åˆ°åˆ·æ–°æŒ‰é’®å³è¾¹ */
      #platformSelect {
        order: 2;
        display: inline-block !important;
      }
      
      .rare-numbers {
        order: 0;
        width: 100%;
      }
      
      .filter-container {
        order: 3;
      }
    }
    
    /* æ‰‹æœºå“åº”å¼æ ·å¼ */
    @media (max-width: 768px) {
      .page-title {
        font-size: 20px; /* æ‰‹æœºä¸Šæ ‡é¢˜å­—ä½“å˜å° */
      }
      
      /* æ˜¾ç¤ºå±•å¼€/æŠ˜å æœç´¢æŒ‰é’® */
      .toggle-search-btn {
        display: inline-flex !important;
      }
      
      /* é»˜è®¤éšè—æœç´¢ç»„ä»¶ï¼Œä½†å¹³å°æŒ‰é’®å¸¸é©» */
      .rare-numbers,
      .filter-container {
        display: none !important;
      }
      
      /* å¹³å°æŒ‰é’®å¸¸é©»æ˜¾ç¤º */
      #platformSelect {
        display: inline-block !important;
        width: auto;
        min-width: 100px;
      }
      
      /* æ‰‹æœºä¸Šheader-controlså¸ƒå±€ä¼˜åŒ– */
      .header-controls {
        gap: 8px;
        margin-top: 10px;
        flex-direction: column;
      }
      
      /* åˆ·æ–°ã€å¹³å°ã€å±•å¼€æœç´¢ä¸‰ä¸ªæŒ‰é’®æ”¾åˆ°ä¸€è¡Œå¹¶åˆ—æ˜¾ç¤º */
      .header-controls > .btn-primary,
      #platformSelect,
      .core-controls {
        display: inline-flex !important;
        flex: 1;
      }
      
      /* è°ƒæ•´ä¸‰ä¸ªæŒ‰é’®çš„å¸ƒå±€ */
      .header-controls {
        display: flex !important;
        flex-direction: row !important;
        flex-wrap: wrap !important;
        align-items: center !important;
      }
      
      /* åˆ·æ–°æ•°æ®æŒ‰é’®æ ·å¼ */
      .header-controls > .btn-primary {
        padding: 8px 10px;
        font-size: 12px;
      }
      
      /* å¹³å°ä¸‹æ‹‰æ¡†æ ·å¼è°ƒæ•´ */
      #platformSelect {
        padding: 8px 10px;
        font-size: 12px;
        margin: 0;
      }
      
      /* æ ¸å¿ƒæ§åˆ¶æŒ‰é’®å®¹å™¨æ ·å¼ */
      .core-controls {
        padding: 0;
        gap: 8px;
      }
      
      /* å±•å¼€æœç´¢ç»„ä»¶æŒ‰é’®æ ·å¼ */
      .core-controls > .toggle-search-btn {
        padding: 8px 10px;
        font-size: 12px;
        background: transparent;
        color: var(--accent-color);
        border: 1px solid rgba(0, 210, 211, 0.4);
        margin: 0;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: 600;
      }
      
      /* å±•å¼€æœç´¢æŒ‰é’®æ‚¬åœæ•ˆæœ */
      .core-controls > .toggle-search-btn:hover {
        background: rgba(0, 210, 211, 0.1);
        border-color: var(--accent-color);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 210, 211, 0.2);
      }
      
      /* å±•å¼€çŠ¶æ€æ ·å¼ - æ˜¾ç¤ºæ‰€æœ‰æœç´¢ç»„ä»¶ */
      .header-controls.expanded {
        gap: 12px;
      }
      
      /* å±•å¼€ååˆ·æ–°ã€å¹³å°ã€æ”¶èµ·ä¸‰ä¸ªæŒ‰é’®ä»ç„¶ä¿æŒä¸€è¡Œå¹¶åˆ—æ˜¾ç¤º */
      .header-controls.expanded > .btn-primary,
      .header-controls.expanded > #platformSelect,
      .header-controls.expanded > .core-controls {
        display: inline-flex !important;
        flex: 1;
      }
      
      /* å±•å¼€åæ§åˆ¶æŒ‰é’®å®¹å™¨çš„å¸ƒå±€ */
      .header-controls.expanded {
        display: flex !important;
        flex-direction: row !important;
        flex-wrap: wrap !important;
        align-items: center !important;
      }
      
      /* å±•å¼€åæœç´¢ç»„ä»¶çš„å¸ƒå±€ */
      .header-controls.expanded > .rare-numbers,
      .header-controls.expanded > .filter-container {
        width: 100% !important;
        order: 3;
      }
      
      /* å±•å¼€æ—¶æ˜¾ç¤ºæ‰€æœ‰æœç´¢ç»„ä»¶ */
      .header-controls.expanded .filter-container {
        display: flex !important;
        flex-direction: column !important;
        align-items: stretch !important;
        width: 100% !important;
      }
      
      /* å±•å¼€æ—¶æ˜¾ç¤ºè‡ªå®šä¹‰ç¨€æœ‰æ¬¾è¾“å…¥æ¡† */
      .header-controls.expanded .rare-numbers {
        display: block !important;
        width: 100% !important;
      }
      
      /* æ‰‹æœºä¸Šç¨€æœ‰æ¬¾è¾“å…¥æ¡†æ ·å¼ä¼˜åŒ– */
      .rare-keywords-input {
        width: calc(100% - 30px) !important;
        max-width: 100% !important;
        padding: 8px 12px !important;
        font-size: 12px !important;
      }
      
      /* å±•å¼€æœç´¢æ¡†åç»„ä»¶å®½åº¦è‡ªé€‚åº”å¯¹é½æ˜¾ç¤º */
      .header-controls.expanded .filter-container > * {
        width: 100% !important;
        max-width: 100% !important;
        margin: 5px 0 !important;
      }
      
      /* ç¡®ä¿æ‰€æœ‰è¾“å…¥æ¡†åœ¨æ‰‹æœºä¸Šä¸è¶…å‡ºå±å¹• */
      @media (max-width: 768px) {
        /* è®¾ç½®box-sizingï¼Œç¡®ä¿paddingå’Œborderä¸å¢åŠ å…ƒç´ æ€»å®½åº¦ */
        .filter-input {
          box-sizing: border-box !important;
        }
        
        /* ç¡®ä¿æ‰€æœ‰ç­›é€‰è¾“å…¥æ¡†å®½åº¦æ­£ç¡®ï¼Œä¸è¶…å‡ºå±å¹• */
        .header-controls.expanded .filter-input {
          width: calc(100% - 20px) !important;
          max-width: calc(100% - 20px) !important;
          min-width: auto !important;
          margin: 5px 10px !important;
        }
        
        /* ç¡®ä¿ä»·æ ¼ç­›é€‰å®¹å™¨å’Œè¾“å…¥æ¡†ä¸è¶…å‡ºå±å¹• */
        .header-controls.expanded .price-filter-container {
          width: calc(100% - 20px) !important;
          margin: 5px 10px !important;
        }
        
        .header-controls.expanded .price-input {
          width: calc(50% - 8px) !important;
          margin: 0 !important;
        }
        
        /* ç¡®ä¿ç­›é€‰å®¹å™¨ä¸è¶…å‡ºå±å¹• */
        .header-controls.expanded .filter-container {
          padding: 0 !important;
          margin: 0 !important;
        }
      }
      
      /* ä¼˜åŒ–ç­›é€‰å®¹å™¨å†…ç»„ä»¶çš„å¸ƒå±€ */
      .header-controls.expanded .filter-container {
        gap: 8px !important;
      }
      
      /* ä»·æ ¼ç­›é€‰å®¹å™¨è‡ªé€‚åº”å®½åº¦ */
      .header-controls.expanded .price-filter-container {
        flex-direction: row !important;
        gap: 8px !important;
        justify-content: space-between !important;
      }
      
      /* ä»·æ ¼è¾“å…¥æ¡†è‡ªé€‚åº”å®½åº¦ */
      .header-controls.expanded .price-input {
        flex: 1 !important;
        width: calc(50% - 12px) !important;
      }
      
      /* ç¡®ä¿æŒ‰é’®å®½åº¦è‡ªé€‚åº” */
      .header-controls.expanded .btn {
        width: 100% !important;
        margin: 5px 0 !important;
      }
      
      /* æ‰‹æœºä¸Šç¨€æœ‰æ¬¾å®¹å™¨å†…è¾¹è·ä¼˜åŒ– */
      .rare-numbers details {
        padding: 8px !important;
      }
      
      /* ç¼–å·å†…å®¹è¿‡å¤šæ—¶æœ€å¤šæ˜¾ç¤ºä¸¤è¡Œï¼Œè¶…å‡ºç”¨çœç•¥å· */
      .card-content .card-type,
      .card-content .goods-info,
      .sales-content .sales-id {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
        line-height: 1.5;
      }
      
      /* æ‰‹æœºä¸Šå¡ç‰‡æ ·å¼ä¼˜åŒ–ï¼Œæ›´ç´§å‡‘ */
      .image-card {
        padding: 10px !important;
        height: auto !important;
        min-height: 280px !important;
      }
      
      .image-card img {
        height: 160px !important;
      }
      
      .card-content {
        padding: 2px 0 0 0;
        justify-content: space-between !important;
      }
      
      .card-type {
        font-size: 12px !important;
        margin: 0 !important;
        line-height: 1.1 !important;
      }
      
      .price {
        font-size: 14px !important;
        margin: 0 !important;
        line-height: 1.1 !important;
      }
      
      .goods-info {
        font-size: 11px !important;
        margin: 0 !important;
        line-height: 1.3 !important;
        height: calc(1.3em * 2) !important;
        display: -webkit-box !important;
        -webkit-box-orient: vertical !important;
        -webkit-line-clamp: 2 !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
      }
      
      .link {
        margin-top: 5px !important;
        padding: 4px 8px !important;
        font-size: 11px !important;
        line-height: 1.1 !important;
      }
    }
    
    .rare-numbers {
      margin: 15px 0;
    }
    
    .rare-numbers details {
      background: rgba(0, 168, 255, 0.1);
      border-radius: 8px;
      padding: 10px;
      border: 1px solid rgba(0, 168, 255, 0.3);
    }
    
    .rare-numbers summary {
      cursor: pointer;
      padding: 10px 15px;
      background: rgba(0, 168, 255, 0.2);
      border-radius: 6px;
      font-weight: 600;
      list-style: none;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      color: var(--primary-color);
      transition: all 0.3s ease;
    }
    
    .rare-numbers summary:hover {
      background: rgba(0, 168, 255, 0.3);
    }
    
    .rare-numbers summary::before {
      content: 'â–¶';
      display: inline-block;
      margin-right: 8px;
      transition: transform 0.2s;
      font-size: 12px;
    }
    
    .rare-numbers details[open] summary::before {
      transform: rotate(90deg);
    }
    
    .rare-keywords-input {
      width: 100%;
      max-width: 500px;
      padding: 12px 15px;
      border: 1px solid rgba(0, 168, 255, 0.5);
      border-radius: 8px;
      font-size: 14px;
      margin: 10px auto;
      display: block;
      background: rgba(30, 39, 46, 0.7);
      color: var(--light-color);
      transition: all 0.3s ease;
    }
    
    .rare-keywords-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 168, 255, 0.2);
    }
    
    .rare-keywords-hint {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
      margin-top: 5px;
    }
    
    .header-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin-top: 20px;
    }
    
    .btn {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }
    
    .btn-primary {
      background: transparent;
      color: var(--accent-color);
      border: 1px solid rgba(0, 210, 211, 0.4);
    }
    
    .btn-primary:hover {
      background: rgba(0, 210, 211, 0.1);
      border-color: var(--accent-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 210, 211, 0.2);
    }
    
    .btn-secondary {
      background: transparent;
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
    }
    
    .btn-danger {
      background: var(--danger-color);
      color: white;
    }
    
    .btn-danger:hover {
      background: #c23616;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(232, 65, 24, 0.3);
    }
    
    .btn-success {
      background: var(--success-color);
      color: white;
    }
    
    .btn-success:hover {
      background: #44bd32;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(76, 209, 55, 0.3);
    }
    
    .filter-container {
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }
    
    .filter-input {
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 14px;
      border: 1px solid rgba(0, 210, 211, 0.4);
      background: transparent;
      color: var(--accent-color) !important;
      transition: all 0.3s ease;
      box-sizing: border-box;
      font-weight: 600;
    }
    
    .filter-input:hover {
      background: rgba(0, 210, 211, 0.1);
      border-color: var(--accent-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 210, 211, 0.2);
    }
    
    .filter-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(0, 210, 211, 0.2);
    }
    
    /* ç¡®ä¿selectå…ƒç´ çš„å­—ä½“é¢œè‰²ä¸åˆ·æ–°æŒ‰é’®ä¸€è‡´ */
    select.filter-input {
      color: var(--accent-color) !important;
      appearance: none !important;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d2d3' d='M6 9L1 4h10z'/%3E%3C/svg%3E") !important;
      background-repeat: no-repeat !important;
      background-position: right 10px center !important;
      background-size: 12px 12px !important;
      padding-right: 30px !important;
      background-color: transparent !important;
    }
    
    /* ç¡®ä¿åœ¨æ‰€æœ‰çŠ¶æ€ä¸‹ä¸‹æ‹‰ç®­å¤´éƒ½æ˜¾ç¤º */
    select.filter-input:focus,
    select.filter-input:active,
    select.filter-input:valid {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d2d3' d='M6 9L1 4h10z'/%3E%3C/svg%3E") !important;
      background-repeat: no-repeat !important;
      background-position: right 10px center !important;
    }
    
    select.filter-input::-ms-expand {
      display: none;
    }
    
    /* ç¡®ä¿ä¸‹æ‹‰é€‰é¡¹çš„å­—ä½“é¢œè‰²ä¸åˆ·æ–°æŒ‰é’®ä¸€è‡´ */
    select.filter-input option {
      color: var(--accent-color) !important;
      background: rgba(30, 39, 46, 0.9);
    }
    
    /* ç¡®ä¿ä¸‹æ‹‰é€‰é¡¹åœ¨é€‰ä¸­æ—¶çš„èƒŒæ™¯è‰² */
    select.filter-input option:checked {
      background-color: rgba(0, 210, 211, 0.3) !important;
    }
    
    .archive-select {
      min-width: 150px;
      max-width: 180px;
    }
    
    .price-input {
      width: 100px;
    }
    
    #platformSelect {
      min-width: 120px;
      max-width: 140px;
    }
    
    #goodsNoFilter {
      min-width: 200px;
      max-width: 300px;
    }
    
    .btn {
      padding: 10px 20px;
      font-size: 14px;
    }
    
    .price-filter-container {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .summary {
      text-align: center;
      margin: 15px 0;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      padding: 10px;
      background: rgba(30, 39, 46, 0.5);
      border-radius: 8px;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      font-size: 16px;
      color: rgba(255, 255, 255, 0.7);
	   white-space: pre-line; /* ä¿ç•™æ¢è¡Œç¬¦ */
	  color: white;
    }
    
    /* ä¿®æ­£åˆ†ç•Œçº¿å®¹å™¨æ ·å¼ */
    .divider-container {
      width: 100%;
      max-width: 2200px;
      margin: 30px auto;
    }
    
    .divider {
      display: flex;
      align-items: center;
      width: 100%;
      margin: 20px 0;
    }
    
    .divider-line {
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
    }
    
    .divider-text {
      padding: 0 20px;
      font-size: 20px;
      font-weight: 600;
      color: var(--primary-color);
      text-transform: uppercase;
      letter-spacing: 2px;
      white-space: nowrap;
    }

    
    /* ä¼˜åŒ–ç½‘æ ¼å®¹å™¨å¸ƒå±€ - å‡å°‘ç©ºç™½ï¼Œæ¯è¡Œæ˜¾ç¤º6ä¸ªå¡ç‰‡ */
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 15px;
      padding: 15px;
      max-width: 2200px;
      margin: 0 auto;
    }
    
    /* å¤§å±å¹•æ—¶å›ºå®šæ¯è¡Œ8ä¸ªå¡ç‰‡ */
    @media (min-width: 1800px) {
      .grid-container {
        grid-template-columns: repeat(8, 1fr);
      }
    }
    
    /* ä¸­ç­‰å±å¹•æ—¶æ¯è¡Œ4ä¸ªå¡ç‰‡ */
    @media (min-width: 1000px) and (max-width: 1700px) {
      .grid-container {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      }
    }
    
    /* å°å±å¹•æ—¶æ¯è¡Œ2ä¸ªå¡ç‰‡ */
    @media (max-width: 799px) {
      .grid-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        padding: 10px;
      }
    }
    
    /* ç»Ÿä¸€å¡ç‰‡å°ºå¯¸ */
    .image-card {
      background: rgba(30, 39, 46, 0.7);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 380px; /* å›ºå®šé«˜åº¦ */
    }
    
    .image-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to bottom right,
        rgba(0, 168, 255, 0.1) 0%,
        rgba(0, 168, 255, 0) 50%,
        rgba(0, 210, 211, 0.1) 100%
      );
      transform: rotate(30deg);
      z-index: 0;
    }
    
    .image-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 40px rgba(0, 168, 255, 0.2);
      border-color: rgba(0, 168, 255, 0.3);
    }
    
    .image-card > * {
      position: relative;
      z-index: 1;
    }
    
    /* ç»Ÿä¸€å›¾ç‰‡å°ºå¯¸ */
    .image-card img {
      width: 100%;
      height: 220px; /* å›ºå®šå›¾ç‰‡é«˜åº¦ */
      object-fit: cover; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: zoom-in;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.2);
    }
    
    .image-card img:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 15px rgba(0, 168, 255, 0.3);
    }
    
    .card-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 10px 0 0 0;
    }
    
    .card-type {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 8px;
    }
    
    .price {
      color: var(--accent-color);
      font-weight: bold;
      margin: 8px 0 5px;
      font-size: 18px;
    }
    
    .goods-info {
      color: rgba(255, 255, 255, 0.9);
      margin: 5px 0;
      font-size: 13px;
    }
    
    .link {
      display: inline-block;
      margin-top: 10px;
      padding: 6px 12px;
      background: rgba(0, 168, 255, 0.2);
      border-radius: 6px;
      color: var(--primary-color);
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 1px solid rgba(0, 168, 255, 0.3);
    }
    
    .link:hover {
      background: rgba(0, 168, 255, 0.3);
      color: white;
      transform: translateY(-2px);
    }
    
    .no-results {
      text-align: center;
      padding: 40px;
      color: rgba(255, 255, 255, 0.6);
      font-size: 16px;
      background: rgba(30, 39, 46, 0.5);
      border-radius: 12px;
      max-width: 800px;
      margin: 0 auto;
      grid-column: 1 / -1;
    }
    
    /* å›¾ç‰‡é¢„è§ˆå±‚æ ·å¼ */
    .preview-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      justify-content: center;
      align-items: center;
      z-index: 1003;
      cursor: zoom-out;
    }
    
    .preview-overlay.active {
      display: flex;
    }
    
    .preview-overlay img {
      max-width: 90%;
      max-height: 90%;
      transform: scale(1);
      transition: transform 0.3s ease;
      box-shadow: 0 0 40px rgba(0, 168, 255, 0.3);
      border-radius: 8px;
    }
    
    .zoom-controls {
      position: fixed;
      bottom: 40px;
      right: 40px;
      display: flex;
      gap: 15px;
    }
    
    .zoom-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(30, 39, 46, 0.8);
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .zoom-btn:hover {
      background: var(--primary-color);
      transform: scale(1.1);
    }
    
    /* å”®å–å¼¹çª—æ ·å¼ - ä¿®å¤æ»šåŠ¨ç©¿é€é—®é¢˜ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
      display: flex;
    }
    
    .modal-content {
      background: rgba(30, 39, 46, 0.95);
      border-radius: 12px;
      width: 90%;
      max-width: 1800px;
      max-height: 90vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }
    
    .modal-overlay.active .modal-content {
      transform: translateY(0);
    }
    
    .modal-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-title {
      font-size: 20px;
      font-weight: 600;
      margin: 0;
      color: var(--primary-color);
    }
    
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: rgba(255, 255, 255, 0.6);
      transition: all 0.3s ease;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    .close-modal:hover {
      color: white;
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* ä¿®å¤æ»šåŠ¨ç©¿é€ */
    .modal-body {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
      overscroll-behavior: contain; /* é˜²æ­¢æ»šåŠ¨ç©¿é€åˆ°ä¸»é¡µ */
      -webkit-overflow-scrolling: touch; /* ç§»åŠ¨ç«¯æµç•…æ»šåŠ¨ */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    
    /* å”®å–å¼¹çª—ç½‘æ ¼å¸ƒå±€ */
    .sales-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      justify-items: center;
      align-items: start;
    }
    
    @media (min-width: 1200px) {
      .sales-grid {
        grid-template-columns: repeat(6, 1fr);
      }
    }
    
    .sales-card {
      background: rgba(30, 39, 46, 0.7);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      height: auto;
      min-height: 260px;
    }
    
    .sales-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(0, 168, 255, 0.2);
      border-color: rgba(0, 168, 255, 0.3);
    }
    
    .sales-card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: zoom-in;
      transition: all 0.3s ease;
    }
    
    .sales-card img:hover {
      transform: scale(1.03);
    }
    
    .sales-content {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 4px 0 0 0;
      gap: 4px;
      flex-shrink: 0;
    }
    
    .sales-price {
      color: var(--accent-color);
      font-weight: bold;
      margin: 0;
      font-size: 16px;
    }
    
    .sales-id {
      color: rgba(255, 255, 255, 0.8);
      margin: 0;
      font-size: 12px;
      min-height: 2.4em;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .sales-time {
      color: rgba(255, 255, 255, 0.6);
      margin: 0;
      font-size: 11px;
    }
    
    .modal-loading {
      text-align: center;
      padding: 40px;
      color: rgba(255, 255, 255, 0.6);
    }
    
    .loading-indicator {
      text-align: center;
      padding: 20px;
      color: rgba(255, 255, 255, 0.6);
      font-size: 14px;
      display: none;
    }
    
    .sales-pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      padding: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(30, 39, 46, 0.5);
    }
    
    .pagination-btn {
      padding: 8px 20px;
      background: rgba(0, 168, 255, 0.2);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .pagination-btn:hover:not(:disabled) {
      background: rgba(0, 168, 255, 0.4);
      transform: translateY(-2px);
    }
    
    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .page-info {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      font-weight: 600;
    }
    
    .page-size-select {
      padding: 8px 12px;
      border-radius: 6px;
      background: rgba(30, 39, 46, 0.7);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 14px;
    }
    
    .total-info {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.6);
      margin-left: 20px;
    }
    
    /* å”®å–å¼¹çª—å†…çš„ç­›é€‰å®¹å™¨ */
    .sales-filter-container {
      display: flex;
	  gap: 10px;
      justify-content: center;
      padding: 10px 20px;
      background: rgba(30, 39, 46, 0.3);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .header-controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .filter-container {
        flex-direction: column;
        align-items: stretch;
      }
      
      .price-filter-container {
        justify-content: center;
      }
      
      .image-card {
        height: 350px;
      }
      
      .image-card img {
        height: 180px;
      }
      
      /* æœ€è¿‘å”®å–å¼¹çª—å“åº”å¼æ ·å¼ */
      /* å¼¹çª—å®¹å™¨ */
      .modal-content {
        width: 100% !important;
        height: 100% !important;
        max-height: 100vh !important;
        border-radius: 0 !important;
      }
      
      /* å¼¹çª—ç­›é€‰å®¹å™¨ */
      .sales-filter-container {
        flex-direction: column;
        gap: 8px !important;
        padding: 10px !important;
        box-sizing: border-box !important;
      }
      
      /* ç­›é€‰è¾“å…¥æ¡†å’ŒæŒ‰é’® - ç¡®ä¿ä¸è¶…å‡ºå±å¹• */
      .sales-filter-container .filter-input {
        width: calc(100% - 30px) !important;
        margin: 0 auto !important;
        box-sizing: border-box !important;
      }
      
      .sales-filter-container .btn {
        width: calc(100% - 30px) !important;
        margin: 0 auto !important;
        box-sizing: border-box !important;
      }
      
      /* ç»Ÿä¸€æŒ‰é’®æ ·å¼ */
      .sales-filter-container .btn-danger {
        background: transparent !important;
        color: white !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
      }
      
      .sales-filter-container .btn-secondary {
        background: transparent !important;
      }
      
      /* å”®å–å¡ç‰‡ - é‡‡ç”¨é¦–é¡µå¡ç‰‡æ ·å¼ */
      .sales-card {
        background: rgba(30, 39, 46, 0.7) !important;
        border-radius: 15px !important;
        padding: 10px !important;
        text-align: center !important;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2) !important;
        transition: all 0.3s ease !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        position: relative !important;
        overflow: hidden !important;
        display: flex !important;
        flex-direction: column !important;
        height: auto !important;
        min-height: 280px !important;
      }
      
      .sales-card::before {
        content: '' !important;
        position: absolute !important;
        top: -50% !important;
        left: -50% !important;
        width: 200% !important;
        height: 200% !important;
        background: linear-gradient(
          to bottom right,
          rgba(0, 168, 255, 0.1) 0%,
          rgba(0, 168, 255, 0) 50%,
          rgba(0, 210, 211, 0.1) 100%
        ) !important;
        transform: rotate(30deg) !important;
        z-index: 0 !important;
      }
      
      .sales-card:hover {
        transform: translateY(-5px) !important;
        box-shadow: 0 12px 40px rgba(0, 168, 255, 0.2) !important;
        border-color: rgba(0, 168, 255, 0.3) !important;
      }
      
      .sales-card > * {
        position: relative !important;
        z-index: 1 !important;
      }
      
      /* ç»Ÿä¸€å›¾ç‰‡å°ºå¯¸ */
      .sales-card img {
        width: 100% !important;
        height: 160px !important;
        object-fit: cover !important;
        border-radius: 8px !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        cursor: zoom-in !important;
        transition: all 0.3s ease !important;
        background: rgba(0, 0, 0, 0.2) !important;
      }
      
      .sales-card img:hover {
        transform: scale(1.02) !important;
        box-shadow: 0 4px 15px rgba(0, 168, 255, 0.3) !important;
      }
      
      /* å¡ç‰‡å†…å®¹ç´§å‡‘ - ä¸é¦–é¡µå¡ç‰‡æ ·å¼ä¸€è‡´ */
      .sales-content {
        flex: 1 !important;
        display: flex !important;
        flex-direction: column !important;
        justify-content: flex-start !important;
        padding: 2px 0 0 0 !important;
      }
      
      .sales-price {
        color: var(--accent-color) !important;
        font-weight: bold !important;
        font-size: 14px !important;
        margin: 0 !important;
        line-height: 1.1 !important;
      }
      
      .sales-id {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 11px !important;
        margin: 0 !important;
        line-height: 1.1 !important;
        height: auto !important;
        min-height: calc(1.3em * 2) !important;
        display: -webkit-box !important;
        -webkit-box-orient: vertical !important;
        -webkit-line-clamp: 2 !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
      }
      
      .sales-time {
        color: rgba(255, 255, 255, 0.6) !important;
        font-size: 11px !important;
        margin: 0 !important;
        line-height: 1.1 !important;
      }
      
      /* å”®å–å¡ç‰‡é«˜åº¦è‡ªé€‚åº” */
      .sales-card {
        min-height: 240px !important;
        height: auto !important;
      }
      
      /* ç»Ÿä¸€å…ƒç´ é—´è·ä¸º0ï¼Œå®Œå…¨ç´§å‡‘ */
      .sales-content > * {
        margin: 0 !important;
        padding: 0 !important;
      }
      
      /* åˆ†é¡µæ ·å¼ */
      .sales-pagination {
        flex-wrap: wrap;
        gap: 10px !important;
        padding: 10px !important;
      }
      
      .sales-pagination span,
      .sales-pagination select {
        margin: 0 !important;
      }
      
      /* ç½‘æ ¼å¸ƒå±€ */
      .sales-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 8px !important;
        padding: 8px 15px !important;
        max-width: 100% !important;
        margin: 0 auto !important;
        justify-items: center !important;
        align-items: center !important;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-content">
      <h1 class="page-title">X Meta å±±æµ·æ•°è—äº¤æ˜“æŸ¥è¯¢å·¥å…·</h1>
      
      <div class="rare-numbers">
        <details>
          <summary>
            <span style="color: var(--primary-color);">è‡ªå®šä¹‰ç¨€æœ‰æ¬¾æ ‡å‡†</span>
            <span>ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</span>
          </summary>
          <div style="text-align: center;">
            <input type="text" class="rare-keywords-input" id="rareKeywordsInput" 
                   placeholder="è¾“å…¥ç¨€æœ‰æ¬¾å…³é”®è¯ï¼Œç”¨è‹±æ–‡é€—å·åˆ†éš”" 
                   value="å®‡èˆªå‘˜,æœºç”²,é£è¡Œå‘˜,äº¬å‰§">
            <div class="rare-keywords-hint">å¤šä¸ªå…³é”®è¯ç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œä¿®æ”¹åä¼šè‡ªåŠ¨åº”ç”¨ç­›é€‰</div>
          </div>
        </details>
      </div>
      
      <div class="header-controls">
        <!-- åˆ·æ–°æ•°æ®æŒ‰é’® - PCå’Œæ‰‹æœºéƒ½æ˜¾ç¤º -->
        <button class="btn btn-primary" onclick="fetchData()">
          <span>ğŸ“¡</span>
          <span>åˆ·æ–°æ•°æ®</span>
        </button>
        
        <!-- å¹³å°é€‰æ‹©å™¨ - PCæ˜¾ç¤ºï¼Œæ‰‹æœºéšè—ï¼ˆéšç­›é€‰ç»„ä»¶ä¸€èµ·å±•å¼€ï¼‰ -->
        <select class="filter-input archive-select" id="platformSelect" style="min-width: 120px;">
          <option value="xmate">XMATE</option>
          <option value="å“æ‹">å“æ‹</option>
        </select>
        
        <!-- æ ¸å¿ƒæ§åˆ¶æŒ‰é’®å®¹å™¨ - ä»…æ‰‹æœºæ˜¾ç¤º -->
        <div class="core-controls">
          <!-- æœç´¢ç»„ä»¶å±•å¼€/æŠ˜å æŒ‰é’® - ä»…åœ¨æ‰‹æœºä¸Šæ˜¾ç¤º -->
          <button class="btn toggle-search-btn" onclick="toggleSearchComponents()">
            <span>ğŸ”</span>
            <span id="toggleSearchText">å±•å¼€æœç´¢</span>
          </button>
        </div>
        
        <div class="filter-container">
          <select class="filter-input archive-select" id="categorySelect">
            <option value="all">å…¨éƒ¨åˆ†ç±»</option>
            <option value="character">ç²¾å«</option>
            <option value="badge">å¾½ç« </option>
		<option value="silu">ä¸è·¯å‰ç›¸</option>
            <option value="cultural">å› ä¸ºé•¿æ±Ÿ</option>
            <option value="painting">é—²å¢¨ç”»æ„</option>
		<option value="jiasu">æ–‡ç‰©åŠ é€Ÿä¸­</option>
		<option value="geyun">æ­ŒéŸµå¤ä»Š</option>
          </select>
          <select class="filter-input archive-select" id="archiveIdSelect">
    
          </select>
          
          <input type="text" class="filter-input" id="goodsNoFilter" placeholder="è¾“å…¥è—å“IDè¿›è¡Œç­›é€‰..." onkeypress="handleFilterKeypress(event)">
          
          <div class="price-filter-container"> 
            <input type="number" class="filter-input price-input" id="minPriceFilter" placeholder="æœ€ä½ä»·" min="0">
            <span>-</span>
            <input type="number" class="filter-input price-input" id="maxPriceFilter" placeholder="æœ€é«˜ä»·" min="0">
          </div>
          
          <button class="btn btn-secondary" onclick="applyFilters()">
            <span>ğŸ”</span>
            <span>ç­›é€‰</span>
          </button>
          
          <button class="btn btn-secondary" onclick="clearFilter()">
            <span>ğŸª®ï¸</span>
            <span>æ¸…é™¤</span>
          </button>
          
          <button class="btn btn-secondary" onclick="showRecentSales()">
            <span>ğŸ“š</span>
            <span>æœ€è¿‘å”®å–</span>
          </button>
        </div>
      </div>
      
      <p id="summary" class="summary"></p>
    </div>
  </div>

  <div class="loading" id="loading">æ­£åœ¨åŠ è½½æ•°æ®ï¼Œè¯·ç¨å€™...</div>
  
  <div class="divider-container" id="xiyouDivider">
    <div class="divider">
      <div class="divider-line"></div>
      <div class="divider-text">ç¨€æœ‰æ¬¾</div>
      <div class="divider-line"></div>
    </div>
  </div>
  
  <div class="grid-container" id="xiyou"></div>
  
  <div class="divider-container">
    <div class="divider">
      <div class="divider-line"></div>
      <div class="divider-text">æ™®é€šæ¬¾</div>
      <div class="divider-line"></div>
    </div>
  </div>
  
  <div class="grid-container" id="grid"></div>

  <!-- å›¾ç‰‡é¢„è§ˆå±‚ -->
  <div class="preview-overlay" id="previewOverlay" onclick="closePreview(event)">
    <img id="previewImage" src="" alt="é¢„è§ˆ">
    <div class="zoom-controls">
      <button class="zoom-btn" onclick="zoomIn(event)">ï¼‹</button>
      <button class="zoom-btn" onclick="zoomOut(event)">ï¼</button>
      <button class="zoom-btn" onclick="closePreview(event)">âœ•</button>
    </div>
  </div>

  <!-- æœ€è¿‘å”®å–å¼¹çª— -->
  <div class="modal-overlay" id="salesModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">æœ€è¿‘å”®å–è®°å½•</h3>
        <button class="close-modal" onclick="closeSalesModal()">Ã—</button>
      </div>
      
      <!-- å”®å–å¼¹çª—ç­›é€‰å®¹å™¨ -->
      <div class="sales-filter-container">
        <input type="text" class="filter-input" id="goodsNoSale" placeholder="è¾“å…¥è—å“IDè¿›è¡Œç­›é€‰..." onkeypress="handleSaleFilterKeypress(event)">
        <button class="btn btn-secondary" onclick="applySaleFilter()">
          <span>ğŸ”</span>
          <span>ç­›é€‰</span>
        </button>
        <button class="btn btn-danger" onclick="clearSaleFilter()">
          <span>ğŸ—‘ï¸</span>
          <span>æ¸…é™¤</span>
        </button>
      </div>
      
      <div class="modal-body" id="salesModalBody">
        <div class="modal-loading" id="salesLoading">æ­£åœ¨åŠ è½½æœ€è¿‘å”®å–æ•°æ®...</div>
        <div class="sales-grid" id="salesGrid"></div>
        <div class="loading-indicator" id="loadMoreIndicator">æ­£åœ¨åŠ è½½æ›´å¤šæ•°æ®...</div>
      </div>
      
      <div class="sales-pagination" id="salesPagination" style="display: none;">
        <!-- ç§»é™¤åˆ†é¡µæŒ‰é’®ï¼Œåªä¿ç•™æ•°é‡é€‰æ‹©å™¨ -->
        <span style="color: var(--primary-color);">æ¯é¡µæ˜¾ç¤º: </span>
        <select class="page-size-select" id="pageSizeSelect" onchange="changePageSize()">
          <option value="20">20</option>
          <option value="50" selected>50</option>
          <option value="100">100</option>
        </select>
        <span class="total-info" id="totalInfo">å…± 0 æ¡è®°å½•</span>
      </div>
    </div>
  </div>

  <script>
    let allItems = [];
    let filteredXiyouItems = [];
    let filteredNormalItems = [];
    let xiyouKeywords = [];
    let archiveDetails = {};
    
    // å•†å“åˆ†ç±»æ•°æ®
    // ç®€åŒ–çš„å•†å“æ•°æ®åˆ—è¡¨ï¼Œæ¯ä¸ªå•†å“é¡¹åŒ…å«xmateå’Œpinpaiä¸¤ä¸ªå¹³å°çš„id
    const goodsList = [
      { xmate: '48792', pinpai: '16853', name: 'ç²¾å«PFP', category: 'character' },
      { xmate: '42423', pinpai: '15791', name: 'åˆ›ä¸–å¾½ç« ', category: 'badge' },
      { xmate: '40969', pinpai: '16940', name: 'æ¹–æ¹˜é‡‘ç –', category: 'geyun' },
      { xmate: '49580', pinpai: '16853', name: 'ç²¾å«', category: 'character' },
      { xmate: '49478', pinpai: '16818', name: 'ç´ ä¸‰å½©é¸­å½¢é¦™è–°', category: 'cultural' },
      { xmate: '49589', pinpai: '16845', name: 'äº‘çº¹æ¼†é¼', category: 'cultural' },
      { xmate: '49842', pinpai: '16934', name: 'å¤§é“œé©¬', category: 'cultural' },
      { xmate: '50966', pinpai: '17000', name: 'æ¼³å·çª‘ç»¿å½©é˜¿æ‹‰ä¼¯æ–‡ç“·ç›˜', category: 'cultural' },
      { xmate: '51184', pinpai: '17140', name: 'é¸Ÿ(é¹°)çº¹å½©é™¶å£¶', category: 'cultural' },
      { xmate: '51183', pinpai: '17141', name: 'æ¸”çŒé‡‡è²ç”»åƒç –', category: 'cultural' },
      { xmate: '53213', pinpai: '17139', name: 'è¶Šç‹é¹¿éƒ¢å‰‘', category: 'cultural' },
      { xmate: '42935', pinpai: '15790', name: 'å…°äº­åº', category: 'painting' },
      { xmate: '48455', pinpai: '15982', name: 'çµç¶è¡Œ', category: 'painting' },
      { xmate: '48278', pinpai: '15786', name: 'æ«æºªå‚é’“å›¾', category: 'painting' },
      { xmate: '49013', pinpai: '16936', name: 'ç«¹çŸ³ä¸­å ‚', category: 'painting' },
      { xmate: '49181', pinpai: '16933', name: 'å½©ç»˜æ‡æ·å›¾', category: 'painting' },
      { xmate: '49251', pinpai: '16935', name: 'å½©ç»˜å¥”é©¬è½´', category: 'painting' },
      { xmate: '40624', pinpai: '15805', name: 'äºŒåäº”å¼¦ç‘Ÿ', category: 'geyun' },
      { xmate: '40742', pinpai: '15803', name: 'è™æ•”', category: 'geyun' },
      { xmate: '40493', pinpai: '15808', name: 'å•†é“œè±•ç£¬', category: 'geyun' },
      { xmate: '40743', pinpai: '15801', name: 'å‡¤ç®«', category: 'geyun' },
      { xmate: '40491', pinpai: '15810', name: 'è±¡çº¹é“œé“™', category: 'geyun' },
      { xmate: '40492', pinpai: '15807', name: 'è™é’®é“œé¿äº', category: 'geyun' },
      { xmate: '40625', pinpai: '15804', name: 'ç‹¬å¹½ä¸ƒå¼¦ç´', category: 'geyun' },
      { xmate: '40625', pinpai: '16973', name: 'ç‹¬å¹½é›…ä¹', category: 'geyun' },
      { xmate: '41902', pinpai: '15797', name: 'ç™½è™çº¹ç“¦å½“', category: 'jiasu' },
      { xmate: '41968', pinpai: '15793', name: 'å¤§è§’ç›˜ç¾Šçº¹å½©é™¶ç½', category: 'jiasu' },
      { xmate: '43038', pinpai: '16938', name: 'æˆ˜å›½äº”ç‰›ç›–é“œè´®è´å™¨', category: 'jiasu' },
      { xmate: '41903', pinpai: '15799', name: 'å‰è—©ä¹é¾™é’®å¯¿å±±çŸ³å°', category: 'jiasu' },
      { xmate: '41967', pinpai: '15795', name: 'ç‹ç‹¸å¤´é’é“œé¥°ä»¶', category: 'jiasu' },
      { xmate: '45793', pinpai: '15788', name: 'ç¿”é¹­çº¹é“œé¼“', category: 'jiasu' },
      { xmate: '45792', pinpai: '15787', name: 'ç¾½çº¹é“œå‡¤ç¯', category: 'jiasu' },
      { xmate: '53424', pinpai: '17159', name: 'å½©ç»˜ç°é™¶å‚å†›æˆä¿‘', category: 'silu' },
      ];
    
    // æœ€è¿‘å”®å–ç›¸å…³å˜é‡
    let currentSalesPage = 1;
    let currentSalesPageSize = 50;
    let totalSalesCount = 0;
    let isSalesLoading = false;
    let saleFilterKeyword = '';
    let currentScale = 1;  // å›¾ç‰‡é¢„è§ˆç¼©æ”¾æ¯”ä¾‹
    let hasMoreSalesData = false;
    let salesScrollHandler = null; // æ»šåŠ¨äº‹ä»¶å¤„ç†å™¨

    // åˆ‡æ¢æœç´¢ç»„ä»¶å±•å¼€/æŠ˜å çŠ¶æ€
    function toggleSearchComponents() {
      const headerControls = document.querySelector('.header-controls');
      const toggleSearchText = document.getElementById('toggleSearchText');
      
      // åˆ‡æ¢å±•å¼€/æŠ˜å çŠ¶æ€
      headerControls.classList.toggle('expanded');
      
      // æ›´æ–°æŒ‰é’®æ–‡æœ¬
      if (headerControls.classList.contains('expanded')) {
        toggleSearchText.textContent = 'æ”¶èµ·æœç´¢';
      } else {
        toggleSearchText.textContent = 'å±•å¼€æœç´¢';
      }
    }
    
    // è·å–archiveId
    function getArchiveId() {
      const select = document.getElementById('archiveIdSelect');
      return select && select.value ? select.value : "48792";
    }
    
    // è·å–å½“å‰é€‰æ‹©çš„å¹³å°
    function getCurrentPlatform() {
      const platformSelect = document.getElementById('platformSelect');
      return platformSelect && platformSelect.value ? platformSelect.value : 'xmate';
    }
    
    // æ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦è·³è¿‡fetchData()è°ƒç”¨
    let skipNextFetchData = false;
    
    // åˆ†ç±»è”åŠ¨å‡½æ•°
    function updateGoodsByCategory() {
      const categorySelect = document.getElementById('categorySelect');
      const archiveIdSelect = document.getElementById('archiveIdSelect');
      if (!categorySelect || !archiveIdSelect) return;
      
      const selectedCategory = categorySelect.value;
      const currentSelectedGoods = archiveIdSelect.value;
      const currentPlatform = getCurrentPlatform();
      
      // è®¾ç½®æ ‡å¿—ä½ï¼Œè·³è¿‡ä¸‹ä¸€æ¬¡ç”±DOMæ›´æ–°è§¦å‘çš„fetchData()è°ƒç”¨
      skipNextFetchData = true;
      
      // æ¸…ç©ºç°æœ‰é€‰é¡¹
      archiveIdSelect.innerHTML = '';
      
      // æ ¹æ®é€‰ä¸­çš„åˆ†ç±»è¿‡æ»¤å•†å“åˆ—è¡¨
      let filteredGoods;
      if (selectedCategory === 'all') {
        filteredGoods = goodsList;
      } else {
        filteredGoods = goodsList.filter(goods => goods.category === selectedCategory);
      }
      
      // æ·»åŠ æ–°é€‰é¡¹ï¼Œæ ¹æ®å¹³å°é€‰æ‹©å¯¹åº”çš„id
      filteredGoods.forEach(goods => {
        const option = document.createElement('option');
        // æ ¹æ®å½“å‰å¹³å°é€‰æ‹©å¯¹åº”çš„idå­—æ®µ
        const platformId = currentPlatform === 'xmate' ? goods.xmate : goods.pinpai;
        option.value = platformId;
        option.textContent = goods.name;
        if (platformId === currentSelectedGoods) {
          option.selected = true;
        }
        archiveIdSelect.appendChild(option);
      });
      
      // å¦‚æœå½“å‰é€‰ä¸­çš„å•†å“ä¸åœ¨æ–°çš„å•†å“åˆ—è¡¨ä¸­ï¼Œåˆ™é€‰æ‹©ç¬¬ä¸€ä¸ªå•†å“
      if (!archiveIdSelect.value) {
        archiveIdSelect.selectedIndex = 0;
      }
      
      // é‡ç½®æ ‡å¿—ä½ï¼Œç¡®ä¿ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©å•†å“æ—¶èƒ½æ­£å¸¸è§¦å‘fetchData()
      skipNextFetchData = false;
      
      // ç›´æ¥è§¦å‘æ•°æ®åˆ·æ–°
      fetchData();
    }

    // è·å–ç¨€æœ‰æ¬¾å…³é”®è¯
    function getXiyouKeywords() {
      const input = document.getElementById('rareKeywordsInput');
      if (input && input.value.trim()) {
        return input.value.split(',').map(keyword => keyword.trim()).filter(keyword => keyword.length > 0);
      }
      return xiyouKeywords;
    }

    // è·å–å•†å“è¯¦æƒ…ä¿¡æ¯  
    async function fetchArchiveDetails() {
      const archiveId = getArchiveId();
      
      if (archiveDetails[archiveId]) {
        const archiveData = archiveDetails[archiveId];
        if (archiveData && archiveData.archiveName) {
          const pageTitleElement = document.getElementById('pageTitle');
          if (pageTitleElement) {
            pageTitleElement.textContent = `X Meta ${archiveData.archiveName}äº¤æ˜“å®æ—¶é¢„è§ˆ`;
          }
        }
        return archiveData;
      }

      const url = "https://api.x-metash.cn/h5/goods/archive";
      const headers = {
        'accept': '*/*',
        'content-type': 'application/json',
        'origin': 'https://xmeta.x-metash.cn',
        'referer': 'https://xmeta.x-metash.cn/',
      };

      const body = {
        archiveId: archiveId,
        platformId: "923",
        source: "1",
        page: 1,
        pageSize: 20,
        sellStatus: 1
      };

      try {
        const resp = await fetch(url, {
            method: "POST",
            headers: headers,
            body: JSON.stringify(body),
            mode: 'cors',
            credentials: 'omit'
          });

        if (!resp.ok) throw new Error(`å•†å“è¯¦æƒ…è¯·æ±‚å¤±è´¥: ${resp.status}`);
        const result = await resp.json();
        if (result.code !== 200) throw new Error(`å•†å“è¯¦æƒ…APIé”™è¯¯: ${result.msg}`);

        const archiveData = result.data;
        if (archiveData && archiveData.archiveName) {
          const pageTitleElement = document.getElementById('pageTitle');
          if (pageTitleElement) {
            pageTitleElement.textContent = `X Meta ${archiveData.archiveName}äº¤æ˜“å®æ—¶é¢„è§ˆ`;
          }
          archiveDetails[archiveId] = archiveData;
          return archiveData;
        }
      } catch (error) {
        console.warn('è·å–å•†å“è¯¦æƒ…å¤±è´¥:', error);
        const pageTitleElement = document.getElementById('pageTitle');
        if (pageTitleElement) {
          pageTitleElement.textContent = 'X Meta å±±æµ·æ•°è—äº¤æ˜“å¹³å°';
        }
      }
      return null;
    }

    // è·å–å•†å“å›¾ç‰‡URL
    function getGoodsImageUrl(item, archiveData) {
      if (item.pfpImg && item.pfpImg.trim() !== '') {
        return item.pfpImg;
      }
      if (archiveData && archiveData.archiveImage && Array.isArray(archiveData.archiveImage) && archiveData.archiveImage.length > 0) {
        return archiveData.archiveImage[0];
      }
      return '';
    }

    // å›¾ç‰‡åŠ è½½å‡½æ•°
    function loadImage(imgElement, imageUrl) {
      if (!imageUrl) {
        imgElement.src = '';
        return;
      }

      // è®¾ç½®åŠ è½½çŠ¶æ€
      imgElement.style.opacity = '0.3';
      
      imgElement.onload = () => {
        imgElement.style.opacity = '1';
      };
      imgElement.onerror = () => {
        imgElement.src = '';
        imgElement.style.opacity = '1';
      };
      imgElement.src = imageUrl;
    }

    // åŠ è½½æ•°æ®
    async function fetchData() {
      const grid = document.getElementById('grid');
      const xiyou = document.getElementById('xiyou');
      const loading = document.getElementById('loading');
      const summary = document.getElementById('summary');
      if (!grid || !xiyou || !loading || !summary) {
        console.error('ç¼ºå°‘å¿…è¦çš„DOMå…ƒç´ ');
        return;
      }
      
      grid.innerHTML = '';
      xiyou.innerHTML = '';
      loading.style.display = 'block';
      summary.textContent = '';
      
      // æ¸…ç©ºç­›é€‰æ¡ä»¶
      const goodsNoFilter = document.getElementById('goodsNoFilter');
      const minPriceFilter = document.getElementById('minPriceFilter');
      const maxPriceFilter = document.getElementById('maxPriceFilter');
      if (goodsNoFilter) goodsNoFilter.value = '';
      if (minPriceFilter) minPriceFilter.value = '';
      if (maxPriceFilter) maxPriceFilter.value = '';

      const archiveId = getArchiveId();
      const currentPlatform = getCurrentPlatform();
      let archiveData = null;
      
      // åªæœ‰xmateå¹³å°éœ€è¦è·å–archiveDetails
      if (currentPlatform === 'xmate') {
        archiveData = await fetchArchiveDetails();
      }

      let page = 1;
      const pageSize = 100;
      allItems = [];
      filteredXiyouItems = [];
      filteredNormalItems = [];

      try {
        if (currentPlatform === 'xmate') {
          // xmateå¹³å°æ•°æ®è·å–é€»è¾‘
          const url = "https://api.x-metash.cn/h5/goods/archiveGoods";
          const headers = {
            'accept': '*/*',
            'content-type': 'application/json',
            'origin': 'https://xmeta.x-metash.cn',
            'referer': 'https://xmeta.x-metash.cn/',
          };
          
          while (true) {
            const body = {
              archiveId: archiveId,
              platformId: "923",
              source: "1",
              page: page,
              pageSize: pageSize,
              sellStatus: 1
            };

            const resp = await fetch(url, {
            method: "POST",
            headers: headers,
            body: JSON.stringify(body),
            mode: 'cors',
            credentials: 'omit'
          });

            if (!resp.ok) {
              console.error(`ç¬¬${page}é¡µè¯·æ±‚å¤±è´¥`, resp.status);
              break;
            }

            const result = await resp.json();
            if (result.code !== 200) {
              console.error("APIè¿”å›é”™è¯¯ï¼š", result.msg);
              break;
            }

            const goods = result.data?.goodsArchiveList || [];
            if (goods.length === 0) {
              console.log(`ç¬¬${page}é¡µæ— æ•°æ®ï¼Œç»“æŸ`);
              break;
            }

            // ä¸ºxmateæ•°æ®æ·»åŠ å¹³å°æ ‡è¯†
            goods.forEach(item => {
              item.platform = 'xmate';
            });
            
            allItems = allItems.concat(goods);
            console.log(`ç¬¬${page}é¡µè·å– ${goods.length} æ¡æ•°æ®`);

            if (goods.length < pageSize) break;
            page++;
          }
        } else if (currentPlatform === 'å“æ‹') {
           // å“æ‹å¹³å°æ•°æ®è·å–é€»è¾‘
          const url = "/api/data";
          const headers = {
            'accept': '*/*',
            'content-type': 'application/json'
          };
          
          while (true) {
            const body = {
              template_id: archiveId,
              limit: pageSize,
              is_sell: 0,
              type: 1,
              page: page,
              is_booking: 2,
              version: "1.5.2"
            };

            const resp = await fetch(url, {
              method: "POST",
              headers: headers,
              body: JSON.stringify(body),
              mode: 'cors',
              credentials: 'omit'
            });

            if (!resp.ok) {
              console.error(`ç¬¬${page}é¡µè¯·æ±‚å¤±è´¥`, resp.status);
              break;
            }

            const result = await resp.json();
            if (result.code !== 1) {
              console.error("APIè¿”å›é”™è¯¯ï¼š", result.msg);
              break;
            }

            const goods = result.data?.data || [];
            if (goods.length === 0) {
              console.log(`ç¬¬${page}é¡µæ— æ•°æ®ï¼Œç»“æŸ`);
              break;
            }

            // è½¬æ¢å“æ‹æ•°æ®æ ¼å¼ä¸ºç»Ÿä¸€æ ¼å¼
            const formattedGoods = goods.map(item => {
              // å¤„ç†å›¾ç‰‡ï¼Œå–æœ€åä¸€å¼ å¦‚æœæœ‰å¤šä¸ª
              // ç›´æ¥ä½¿ç”¨imageså­—æ®µï¼Œè¿™æ˜¯å“æ‹å¹³å°å›¾ç‰‡çš„ä¸»è¦æ¥æº
              let imageUrl = '';
              
              if (item.images) {
                // å¦‚æœimagesæ˜¯å­—ç¬¦ä¸²ä¸”åŒ…å«é€—å·ï¼ŒæŒ‰é€—å·åˆ†å‰²å–æœ€åä¸€å¼ 
                if (typeof item.images === 'string') {
                  if (item.images.includes(',')) {
                    const imagesArray = item.images.split(',').map(img => img.trim()).filter(img => img);
                    if (imagesArray.length > 0) {
                      imageUrl = imagesArray[imagesArray.length - 1];
                    }
                  } else {
                    // åªæœ‰ä¸€å¼ å›¾ç‰‡
                    imageUrl = item.images;
                  }
                } else if (Array.isArray(item.images) && item.images.length > 0) {
                  // å¦‚æœæ˜¯æ•°ç»„ï¼Œç›´æ¥å–æœ€åä¸€å¼ 
                  imageUrl = item.images[item.images.length - 1];
                }
              }
              
              // å¦‚æœimageså­—æ®µä¸ºç©ºï¼Œæ‰ä½¿ç”¨item.imageä½œä¸ºå¤‡é€‰
              if (!imageUrl && item.image) {
                imageUrl = item.image;
              }
              
              // å»é™¤å›¾ç‰‡é“¾æ¥ä¸­çš„åæ–œæ è½¬ä¹‰å­—ç¬¦
              if (imageUrl) {
                imageUrl = imageUrl.replace(/\\/g, '');
              }
              
              return {
                goodsId: item.id,
                goodsNo: item.sn , // å“æ‹æ²¡æœ‰goodsNoï¼Œç”¨snæˆ–titleä»£æ›¿
                goodsPrice: item.price,
                pfpImg: imageUrl,
                platform: 'å“æ‹',
                // ä¿ç•™åŸå§‹æ•°æ®ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨
                originalData: item
              };
            });
            
            allItems = allItems.concat(formattedGoods);
            console.log(`ç¬¬${page}é¡µè·å– ${goods.length} æ¡æ•°æ®`);

            // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ›´å¤šæ•°æ®
            const totalPages = result.data?.last_page || 1;
            if (page >= totalPages) break;
            page++;
          }
        }

        loading.style.display = 'none';
        filteredXiyouItems = [...allItems.filter(item => isXiyouItem(item))];
        filteredNormalItems = [...allItems.filter(item => !isXiyouItem(item))];
        renderItems(archiveData);
        updateSummary();

      } catch (err) {
        if (err.name === 'TypeError' && err.message.includes('Failed to fetch')) {
        loading.textContent = `å“æ‹æ•°æ®è¯»å–éœ€è¦ä¸´æ—¶å…³é—­è°·æ­Œæµè§ˆå™¨çš„è·¨åŸŸæ ¡éªŒï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š

Windowsï¼šæŒ‰Win+Rï¼Œè¾“å…¥cmdæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œåœ¨å¼¹çª—ä¸­è¾“å…¥ "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe" --disable-web-security --user-data-dir=C:\\TempChromeData å¯åŠ¨æµè§ˆå™¨ï¼Œç„¶åå°†æ–‡ä»¶æ‹–åŠ¨åˆ°æµè§ˆå™¨æ‰“å¼€å³å¯

Macï¼šæ‰“å¼€ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼šopen -n /Applications/Google\\ Chrome.app --args --disable-web-security --user-data-dir=/tmp/chrome_dev_test å›è½¦å¯åŠ¨æµè§ˆå™¨ï¼Œç„¶åå°†æ–‡ä»¶æ‹–åŠ¨åˆ°æµè§ˆå™¨æ‰“å¼€å³å¯`;
        } else {
          loading.textContent = `âŒ è¯·æ±‚å¤±è´¥: ${err.message}`;
        }
        console.error('æ•°æ®è·å–å¤±è´¥:', err);
      }
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºç¨€æœ‰æ¬¾
    function isXiyouItem(item) {
      const currentPlatform = getCurrentPlatform();
      const keywords = getXiyouKeywords();
      
      // æ ¹æ®å¹³å°ä¸åŒï¼Œç¨€æœ‰æ¬¾åˆ¤æ–­é€»è¾‘å¯èƒ½æœ‰æ‰€ä¸åŒ
      if (currentPlatform === 'xmate') {
        // xmateå¹³å°çš„ç¨€æœ‰æ¬¾åˆ¤æ–­é€»è¾‘
        if (keywords.some(keyword => item.goodsNo && item.goodsNo.toString().includes(keyword))) {
          return true;
        }
      } else if (currentPlatform === 'å“æ‹') {
        // å“æ‹å¹³å°çš„ç¨€æœ‰æ¬¾åˆ¤æ–­é€»è¾‘
        // å‡è®¾å“æ‹å¹³å°çš„ç¨€æœ‰æ¬¾åˆ¤æ–­é€»è¾‘ä¸xmateç›¸åŒï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
        if (keywords.some(keyword => item.goodsNo && item.goodsNo.toString().includes(keyword))) {
          return true;
        }
      }
      return false;
    }

    // åº”ç”¨ç­›é€‰
    function applyFilters() {
      const goodsNoFilter = document.getElementById('goodsNoFilter').value.trim();
      const minPrice = parseFloat(document.getElementById('minPriceFilter').value) || 0;
      const maxPrice = parseFloat(document.getElementById('maxPriceFilter').value) || Infinity;
      const archiveId = getArchiveId();
      const archiveData = archiveDetails[archiveId];
      
      filteredXiyouItems = allItems.filter(item => {
        const isXiyou = isXiyouItem(item);
        const matchesGoodsNo = !goodsNoFilter || (item.goodsNo && item.goodsNo.toString().includes(goodsNoFilter));
        const price = parseFloat(item.goodsPrice) || 0;
        const matchesPrice = price >= minPrice && price <= maxPrice;
        return isXiyou && matchesGoodsNo && matchesPrice;
      });
      
      filteredNormalItems = allItems.filter(item => {
        const isNormal = !isXiyouItem(item);
        const matchesGoodsNo = !goodsNoFilter || (item.goodsNo && item.goodsNo.toString().includes(goodsNoFilter));
        const price = parseFloat(item.goodsPrice) || 0;
        const matchesPrice = price >= minPrice && price <= maxPrice;
        return isNormal && matchesGoodsNo && matchesPrice;
      });
      
      renderItems(archiveData);
      updateSummary();
    }

    // æ¸…ç©ºç­›é€‰
    function clearFilter() {
      document.getElementById('goodsNoFilter').value = '';
      document.getElementById('minPriceFilter').value = '';
      document.getElementById('maxPriceFilter').value = '';
      const archiveId = getArchiveId();
      const archiveData = archiveDetails[archiveId];
      filteredXiyouItems = allItems.filter(item => isXiyouItem(item));
      filteredNormalItems = allItems.filter(item => !isXiyouItem(item));
      renderItems(archiveData);
      updateSummary();
    }

    // ç­›é€‰è¾“å…¥æ¡†å›è½¦äº‹ä»¶
    function handleFilterKeypress(event) {
      if (event.key === 'Enter') {
        applyFilters();
      }
    }

    // æ¸²æŸ“å•†å“
    function renderItems(archiveData) {
      const grid = document.getElementById('grid');
      const xiyou = document.getElementById('xiyou');
      const xiyouDivider = document.getElementById('xiyouDivider');
      if (!grid || !xiyou || !xiyouDivider) return;
      
      grid.innerHTML = '';
      xiyou.innerHTML = '';

      // æ¸²æŸ“ç¨€æœ‰æ¬¾
      if (filteredXiyouItems.length === 0) {
        // ç¨€æœ‰æ¬¾æ•°æ®ä¸ºç©ºï¼Œéšè—æ ‡é¢˜å’Œå®¹å™¨
        xiyouDivider.style.display = 'none';
        xiyou.style.display = 'none';
      } else {
        // ç¨€æœ‰æ¬¾æ•°æ®ä¸ä¸ºç©ºï¼Œæ˜¾ç¤ºæ ‡é¢˜å’Œå®¹å™¨
        xiyouDivider.style.display = 'block';
        xiyou.style.display = 'grid';
        filteredXiyouItems.forEach((item, index) => {
          const card = createItemCard(item, archiveData, 'ç¨€æœ‰æ¬¾', index + 1, '#00d2d3');
          xiyou.appendChild(card);
        });
      }

      // æ¸²æŸ“æ™®é€šæ¬¾
      if (filteredNormalItems.length === 0) {
        grid.innerHTML = '<p class="no-results">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ™®é€šæ¬¾å•†å“</p>';
      } else {
        filteredNormalItems.forEach((item, index) => {
          const card = createItemCard(item, archiveData, 'æ™®é€šæ¬¾', index + 1, '#f5f6fa');
          grid.appendChild(card);
        });
      }
    }

    // åˆ›å»ºå•†å“å¡ç‰‡
    function createItemCard(item, archiveData, type, index, color) {
      const card = document.createElement('div');
      card.className = 'image-card';
      
      // æ ¹æ®å¹³å°ç”Ÿæˆä¸åŒçš„è´­ä¹°é“¾æ¥
      let detailLink;
      if (item.platform === 'xmate') {
        detailLink = `https://xmeta.x-metash.cn/prod/xmeta_mall/index.html#/pages/goodsDetail/index?id=${item.goodsId}`;
      } else if (item.platform === 'å“æ‹') {
        detailLink = `https://h5.zgysmjw.cn/#/pages/goodsDetail/index?id=${item.goodsId}`;
      } else {
        detailLink = '#';
      }
      
      const imageUrl = getGoodsImageUrl(item, archiveData);
      
      card.innerHTML = `
        <img src="" alt="å›¾ç‰‡åŠ è½½ä¸­..." data-src="${imageUrl}">
        <div class="card-content">
          <div class="card-type" style="color: ${color};">${type} ${index}</div>
          <div class="price">ğŸ’° ${item.goodsPrice ?? 'æœªçŸ¥ä»·æ ¼'}</div>
          <div class="goods-info">è—å“IDï¼š${item.goodsNo || 'æœªçŸ¥'}</div>
          <a href="${detailLink}" class="link" target="_blank">ğŸ’µ å¿«é€Ÿè´­ä¹°</a>
        </div>
      `;
      
      const img = card.querySelector('img');
      loadImage(img, imageUrl);
      img.onclick = () => openPreview(imageUrl);
      
      return card;
    }

    // æ›´æ–°æ‘˜è¦
    function updateSummary() {
      const summary = document.getElementById('summary');
      if (!summary) return;
      
      const goodsNoFilter = document.getElementById('goodsNoFilter').value.trim();
      const minPrice = parseFloat(document.getElementById('minPriceFilter').value) || 0;
      const maxPrice = parseFloat(document.getElementById('maxPriceFilter').value) || Infinity;
      const archiveId = getArchiveId();
      
      const totalXiyou = allItems.filter(item => isXiyouItem(item)).length;
      const totalNormal = allItems.filter(item => !isXiyouItem(item)).length;
      
      let filterText = '';
      if (archiveId && archiveId !== "48792") {
        filterText += `å•†å“ID: ${archiveId}`;
      }
      if (goodsNoFilter) {
        if (filterText) filterText += ' | ';
        filterText += `è—å“ID: ${goodsNoFilter}`;
      }
      if (minPrice || maxPrice) {
        if (filterText) filterText += ' | ';
        filterText += `ä»·æ ¼: ${minPrice || '0'} - ${maxPrice || 'âˆ'}`;
      }
      
      if (filterText) {
        summary.textContent = `ç­›é€‰æ¡ä»¶: ${filterText} | ç¨€æœ‰æ¬¾: ${filteredXiyouItems.length}/${totalXiyou} | æ™®é€šæ¬¾: ${filteredNormalItems.length}/${totalNormal} | æ€»è®¡: ${filteredXiyouItems.length + filteredNormalItems.length}/${allItems.length}`;
      } else {
        summary.textContent = `å•†å“ID: ${archiveId} | ç¨€æœ‰æ¬¾: ${totalXiyou} | æ™®é€šæ¬¾: ${totalNormal} | æ€»è®¡: ${allItems.length}`;
      }
    }

    // ===== å›¾ç‰‡é¢„è§ˆåŠŸèƒ½ =====
    function openPreview(src) {
      const overlay = document.getElementById('previewOverlay');
      const img = document.getElementById('previewImage');
      
      if (!overlay || !img) return;
      
      img.onload = () => {
        overlay.style.display = 'flex';
        overlay.classList.add('active');
        currentScale = 1;
        img.style.transform = `scale(${currentScale})`;
      };
      img.src = src;
    }

    function closePreview(event) {
      if (event) event.stopPropagation();
      const overlay = document.getElementById('previewOverlay');
      if (overlay) {
        overlay.style.display = 'none';
        overlay.classList.remove('active');
      }
    }

    function zoomIn(event) {
      if (event) event.stopPropagation();
      const img = document.getElementById('previewImage');
      if (img) {
        currentScale += 0.2;
        img.style.transform = `scale(${currentScale})`;
      }
    }

    function zoomOut(event) {
      if (event) event.stopPropagation();
      const img = document.getElementById('previewImage');
      if (img) {
        currentScale = Math.max(0.4, currentScale - 0.2);
        img.style.transform = `scale(${currentScale})`;
      }
    }

    // äº‹ä»¶ç›‘å¬
    document.getElementById('minPriceFilter').addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        applyFilters();
      }
    });
    
    document.getElementById('maxPriceFilter').addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        applyFilters();
      }
    });

    document.getElementById('rareKeywordsInput').addEventListener('input', function() {
      applyFilters();
    });

    document.getElementById('archiveIdSelect').addEventListener('change', function(e) {
      // æ£€æŸ¥æ˜¯å¦æ˜¯ç¨‹åºè‡ªåŠ¨è§¦å‘çš„changeäº‹ä»¶
      if (e.isTrusted === false || skipNextFetchData) {
        // å¦‚æœä¸æ˜¯ç”¨æˆ·æ‰‹åŠ¨è§¦å‘çš„äº‹ä»¶ï¼Œæˆ–è€…è®¾ç½®äº†è·³è¿‡æ ‡å¿—ä½ï¼Œé‡ç½®æ ‡å¿—ä½å¹¶è·³è¿‡æœ¬æ¬¡fetchData()è°ƒç”¨
        skipNextFetchData = false;
        return;
      }
      fetchData();
    });
    
    document.getElementById('categorySelect').addEventListener('change', function() {
      updateGoodsByCategory();
    });
    
    // ä¿®æ”¹é¡µé¢æ ‡é¢˜
    function updatePageTitle(platform) {
      const titleElement = document.querySelector('title');
      if (titleElement) {
        titleElement.textContent = `${platform} å±±æµ·æ•°è—äº¤æ˜“å¹³å°`;
      }
      
      // åŒæ—¶æ›´æ–°é¡µé¢å†…çš„æ ‡é¢˜
      const pageTitleElement = document.querySelector('.page-title');
      if (pageTitleElement) {
        pageTitleElement.innerHTML = `${platform} å±±æµ·æ•°è—äº¤æ˜“æŸ¥è¯¢å·¥å…·`;
      }
    }
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', function() {
      updateGoodsByCategory();
      // è®¾ç½®æ ‡å¿—ä½ï¼Œè·³è¿‡window.onloadä¸­çš„fetchData()è°ƒç”¨
      skipNextFetchData = true;
      
      // å¹³å°é€‰æ‹©ä¸‹æ‹‰æ¡†äº‹ä»¶ç›‘å¬
      const platformSelect = document.getElementById('platformSelect');
      if (platformSelect) {
        // åˆå§‹åŒ–æ ‡é¢˜
        updatePageTitle(platformSelect.value);
        
        // æ·»åŠ changeäº‹ä»¶ç›‘å¬
        platformSelect.addEventListener('change', function() {
          updatePageTitle(this.value);
          updateGoodsByCategory();
        });
      }
    });
    
    // å”®å–ç­›é€‰è¾“å…¥æ¡†å›è½¦äº‹ä»¶
    function handleSaleFilterKeypress(event) {
      if (event.key === 'Enter') {
        applySaleFilter();
      }
    }
    
    // ===== æœ€è¿‘å”®å–åŠŸèƒ½ =====
    // æ˜¾ç¤ºæœ€è¿‘å”®å–å¼¹çª—
    async function showRecentSales() {
      const modal = document.getElementById('salesModal');
      if (!modal) return;
      
      modal.classList.add('active');
      document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
      
      // åˆå§‹åŒ–çŠ¶æ€
      currentSalesPage = 1;
      saleFilterKeyword = document.getElementById('goodsNoSale').value.trim();
      hasMoreSalesData = true;
      
      // æ¸…é™¤æ»šåŠ¨ç›‘å¬å™¨
      removeScrollListener();
      
      // è®¾ç½®æ»šåŠ¨ç›‘å¬
      setupScrollListener();
      
      // æ¸…ç©ºç°æœ‰æ•°æ®
      const salesGrid = document.getElementById('salesGrid');
      if (salesGrid) salesGrid.innerHTML = '';
      
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      const loadingElement = document.getElementById('salesLoading');
      if (loadingElement) {
        loadingElement.style.display = 'block';
        loadingElement.textContent = 'æ­£åœ¨åŠ è½½æœ€è¿‘å”®å–æ•°æ®...';
      }
      
      // éšè—åŠ è½½æ›´å¤šæŒ‡ç¤ºå™¨
      const loadMoreIndicator = document.getElementById('loadMoreIndicator');
      if (loadMoreIndicator) {
        loadMoreIndicator.style.display = 'none';
      }
      
      // åŠ è½½ç¬¬ä¸€é¡µæ•°æ®
      await loadSalesData(1, currentSalesPageSize);
    }
    
    // è®¾ç½®æ»šåŠ¨ç›‘å¬
    function setupScrollListener() {
      const modalBody = document.getElementById('salesModalBody');
      if (!modalBody) return;
      
      salesScrollHandler = function() {
        if (isSalesLoading || !hasMoreSalesData) return;
        
        const scrollTop = modalBody.scrollTop;
        const scrollHeight = modalBody.scrollHeight;
        const clientHeight = modalBody.clientHeight;
        
        // æ»šåŠ¨åˆ°åº•éƒ¨é™„è¿‘æ—¶åŠ è½½æ›´å¤š
        if (scrollTop + clientHeight >= scrollHeight - 100) {
          loadMoreSalesData();
        }
      };
      
      modalBody.addEventListener('scroll', salesScrollHandler);
    }
    
    // ç§»é™¤æ»šåŠ¨ç›‘å¬
    function removeScrollListener() {
      const modalBody = document.getElementById('salesModalBody');
      if (modalBody && salesScrollHandler) {
        modalBody.removeEventListener('scroll', salesScrollHandler);
        salesScrollHandler = null;
      }
    }
    
    // åŠ è½½æ›´å¤šæ•°æ®
    async function loadMoreSalesData() {
      if (isSalesLoading || !hasMoreSalesData) return;
      
      currentSalesPage++;
      await loadSalesData(currentSalesPage, currentSalesPageSize, true);
    }
    
    // åŠ è½½å”®å–æ•°æ®
    async function loadSalesData(page, pageSize, isLoadMore = false) {
      if (isSalesLoading) return;
      
      isSalesLoading = true;
      const modalBody = document.getElementById('salesModalBody');
      const loadingElement = document.getElementById('salesLoading');
      const loadMoreIndicator = document.getElementById('loadMoreIndicator');
      const pagination = document.getElementById('salesPagination');
      const totalInfo = document.getElementById('totalInfo');
      
      if (!modalBody) {
        isSalesLoading = false;
        return;
      }
      
      try {
        if (page === 1 && !isLoadMore) {
          // ç¬¬ä¸€é¡µï¼Œæ¸…ç©ºå¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
          const salesGrid = document.getElementById('salesGrid');
          if (salesGrid) salesGrid.innerHTML = '';
          
          if (loadingElement) {
            loadingElement.style.display = 'block';
            loadingElement.textContent = 'æ­£åœ¨åŠ è½½æœ€è¿‘å”®å–æ•°æ®...';
          }
        } else if (isLoadMore && loadMoreIndicator) {
          // åŠ è½½æ›´å¤šï¼Œæ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
          loadMoreIndicator.style.display = 'block';
        }
        
        if (pagination) pagination.style.display = 'none';
        
        const archiveId = getArchiveId();
        const currentPlatform = getCurrentPlatform();
        let salesItems = [];
        let totalSalesCount = 0;
        
        if (currentPlatform === 'xmate') {
          // xmateå¹³å°æœ€è¿‘å”®å–æ•°æ®è·å–
          const url = "https://api.x-metash.cn/h5/goods/archiveGoods";
          const headers = {
            'accept': '*/*',
            'content-type': 'application/json',
            'origin': 'https://xmeta.x-metash.cn',
            'referer': 'https://xmeta.x-metash.cn/',
          };
          
          const body = {
            archiveId: archiveId,
            platformId: "923",
            goodsNo: saleFilterKeyword || "",
            source: "1",
            page: page,
            pageSize: pageSize,
            sellStatus: 2
          };

          const resp = await fetch(url, {
            method: "POST",
            headers: headers,
            body: JSON.stringify(body)
          });

          if (!resp.ok) throw new Error(`è¯·æ±‚å¤±è´¥: ${resp.status}`);
          const result = await resp.json();
          if (result.code !== 200) throw new Error(`APIè¿”å›é”™è¯¯: ${result.msg}`);

          salesItems = result.data?.goodsArchiveList || [];
          totalSalesCount = result.data?.total || 0;
        } else if (currentPlatform === 'å“æ‹') {
           // å“æ‹å¹³å°æœ€è¿‘å”®å–æ•°æ®è·å–
          const url = "/api/data";
          const headers = {
            'accept': '*/*',
            'content-type': 'application/json',
          };
          
          // æ„å»ºè¯·æ±‚ä½“ï¼Œä½¿ç”¨ç”¨æˆ·æä¾›çš„å‚æ•°
          const body = {
            template_id: archiveId,
            limit: pageSize,
            page: page,
            type: 1,
            is_sell: 1, // å·²å”®å‡ºçš„å•†å“
            search: saleFilterKeyword, // æœç´¢å†…å®¹
            sort: "id",
            order: "desc",
            is_booking: 2,
            version: "1.5.2"
          };

          const resp = await fetch(url, {
            method: "POST",
            headers: headers,
            body: JSON.stringify(body),
            mode: 'cors',
            credentials: 'omit'
          });

          if (!resp.ok) {
            throw new Error(`è¯·æ±‚å¤±è´¥: ${resp.status}`);
          }
          const result = await resp.json();
          if (result.code !== 1) {
            throw new Error(`APIè¿”å›é”™è¯¯: ${result.msg}`);
          }

          const goods = result.data?.data || [];
          totalSalesCount = result.data?.total || 0;
          
          // è½¬æ¢å“æ‹æ•°æ®æ ¼å¼ä¸ºç»Ÿä¸€æ ¼å¼ï¼Œä¿æŒä¸xmateä¸€è‡´
          salesItems = goods.map(item => {
            // å¤„ç†å›¾ç‰‡ï¼Œå–æœ€åä¸€å¼ å¦‚æœæœ‰å¤šä¸ª
            // ç›´æ¥ä½¿ç”¨imageså­—æ®µï¼Œè¿™æ˜¯å“æ‹å¹³å°å›¾ç‰‡çš„ä¸»è¦æ¥æº
            let imageUrl = '';
            
            if (item.images) {
              // å¦‚æœimagesæ˜¯å­—ç¬¦ä¸²ä¸”åŒ…å«é€—å·ï¼ŒæŒ‰é€—å·åˆ†å‰²å–æœ€åä¸€å¼ 
              if (typeof item.images === 'string') {
                if (item.images.includes(',')) {
                  const imagesArray = item.images.split(',').map(img => img.trim()).filter(img => img);
                  if (imagesArray.length > 0) {
                    imageUrl = imagesArray[imagesArray.length - 1];
                  }
                } else {
                  // åªæœ‰ä¸€å¼ å›¾ç‰‡
                  imageUrl = item.images;
                }
              } else if (Array.isArray(item.images) && item.images.length > 0) {
                // å¦‚æœæ˜¯æ•°ç»„ï¼Œç›´æ¥å–æœ€åä¸€å¼ 
                imageUrl = item.images[item.images.length - 1];
              }
            }
            
            // å¦‚æœimageså­—æ®µä¸ºç©ºï¼Œæ‰ä½¿ç”¨item.imageä½œä¸ºå¤‡é€‰
            if (!imageUrl && item.image) {
              imageUrl = item.image;
            }
            
            // å»é™¤å›¾ç‰‡é“¾æ¥ä¸­çš„åæ–œæ è½¬ä¹‰å­—ç¬¦
            if (imageUrl) {
              imageUrl = imageUrl.replace(/\\/g, '');
            }
            
            // ä½¿ç”¨pay_timeä½œä¸ºå”®å–æ—¶é—´ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨createtimeæˆ–å½“å‰æ—¶é—´
            const saleTime = item.pay_time ? parseInt(item.pay_time) * 1000 : 
                            (item.createtime ? parseInt(item.createtime) * 1000 : Date.now());
            
            return {
              goodsId: item.id,
              goodsNo: item.sn , // å“æ‹æ²¡æœ‰goodsNoï¼Œç”¨snæˆ–titleä»£æ›¿
              goodsPrice: item.price,
              pfpImg: imageUrl,
              timePass: saleTime, // è½¬æ¢ä¸ºæ¯«ç§’æ—¶é—´æˆ³
              platform: 'å“æ‹',
              originalData: item
            };
          });
        }
        
        if (salesItems.length === 0) {
          if (page === 1) {
            if (loadingElement) {
              loadingElement.textContent = 'æš‚æ— å”®å–è®°å½•';
            }
          }
          hasMoreSalesData = false;
          
          if (loadMoreIndicator) {
            loadMoreIndicator.style.display = 'none';
          }
          
          isSalesLoading = false;
          return;
        }
        
        // è·å–å•†å“è¯¦æƒ…ä¿¡æ¯ç”¨äºå›¾ç‰‡æ˜¾ç¤º
        const archiveData = await fetchArchiveDetails();
        
        if (loadingElement) {
          loadingElement.style.display = 'none';
        }
        
        if (pagination) {
          pagination.style.display = 'flex';
        }
        
        // åˆ›å»ºæˆ–è·å–ç½‘æ ¼å®¹å™¨
        let salesGrid = document.getElementById('salesGrid');
        if (!salesGrid) {
          salesGrid = document.createElement('div');
          salesGrid.className = 'sales-grid';
          salesGrid.id = 'salesGrid';
          modalBody.appendChild(salesGrid);
        }
        
        // æ¸²æŸ“å”®å–æ•°æ®
        salesItems.forEach((item, index) => {
          const saleTime = item.timePass;
          const timeText = saleTime ? new Date(saleTime).toLocaleString('zh-CN') : 'æ—¶é—´æœªçŸ¥';
          const imageUrl = getGoodsImageUrl(item, archiveData);
          
          const salesCard = document.createElement('div');
          salesCard.className = 'sales-card';
          salesCard.innerHTML = `
            <img src="" alt="å›¾ç‰‡${index + 1}" data-src="${imageUrl}">
            <div class="sales-content">
              <div class="sales-price">ğŸ’° ${item.goodsPrice || 'æœªçŸ¥ä»·æ ¼'}</div>
              <div class="sales-id">è—å“ID: ${item.goodsNo || 'æœªçŸ¥'}</div>
              <div class="sales-time">å”®å–æ—¶é—´ï¼š${timeText}</div>
            </div>
          `;
          salesGrid.appendChild(salesCard);
          
          // åŠ è½½å›¾ç‰‡
          const img = salesCard.querySelector('img');
          if (imageUrl) {
            loadImage(img, imageUrl);
            img.onclick = () => openPreview(imageUrl);
          }
        });
        
        // æ›´æ–°æ€»æ•°ä¿¡æ¯
        if (totalInfo) {
          const loadedCount = page * pageSize;
          const displayCount = Math.min(loadedCount, totalSalesCount);
          totalInfo.textContent = `å…± ${totalSalesCount} æ¡è®°å½•ï¼Œå·²åŠ è½½ ${displayCount} æ¡`;
        }
        
        // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ›´å¤šæ•°æ®
        hasMoreSalesData = (page * pageSize) < totalSalesCount;
        
        if (!hasMoreSalesData) {
          if (loadMoreIndicator) {
            loadMoreIndicator.style.display = 'none';
          }
        }
        
      } catch (error) {
        console.error('åŠ è½½å”®å–æ•°æ®å¤±è´¥:', error);
        if (loadingElement) {
          loadingElement.textContent = `åŠ è½½å¤±è´¥: ${error.message}`;
        }
      } finally {
        isSalesLoading = false;
        if (loadMoreIndicator) {
          loadMoreIndicator.style.display = 'none';
        }
      }
    }
    
    // æ›´æ”¹æ¯é¡µæ˜¾ç¤ºæ•°é‡
    async function changePageSize() {
      if (isSalesLoading) return;
      
      const pageSizeSelect = document.getElementById('pageSizeSelect');
      const newPageSize = parseInt(pageSizeSelect.value) || 50;
      if (newPageSize === currentSalesPageSize) return;
      
      currentSalesPageSize = newPageSize;
      currentSalesPage = 1;
      hasMoreSalesData = true;
      
      await loadSalesData(currentSalesPage, currentSalesPageSize);
    }
    
    // åº”ç”¨å”®å–ç­›é€‰
    async function applySaleFilter() {
      const goodsNoSaleInput = document.getElementById('goodsNoSale');
      saleFilterKeyword = goodsNoSaleInput ? goodsNoSaleInput.value.trim() : '';
      currentSalesPage = 1;
      hasMoreSalesData = true;
      
      await loadSalesData(currentSalesPage, currentSalesPageSize);
    }
    
    // æ¸…é™¤å”®å–ç­›é€‰
    function clearSaleFilter() {
      const goodsNoSaleInput = document.getElementById('goodsNoSale');
      if (goodsNoSaleInput) {
        goodsNoSaleInput.value = '';
      }
      saleFilterKeyword = '';
      currentSalesPage = 1;
      hasMoreSalesData = true;
      showRecentSales();
    }

    // å…³é—­å”®å–å¼¹çª—
    function closeSalesModal() {
      const modal = document.getElementById('salesModal');
      if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = ''; // æ¢å¤æ»šåŠ¨
      }
      removeScrollListener();
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‹‰å–æ•°æ®
    window.onload = function() {
      if (skipNextFetchData) {
        // å¦‚æœDOMContentLoadedä¸­å·²ç»åŠ è½½äº†æ•°æ®ï¼Œè·³è¿‡æœ¬æ¬¡è°ƒç”¨
        skipNextFetchData = false;
        return;
      }
      fetchData();
    };
  </script>
</body>
</html>